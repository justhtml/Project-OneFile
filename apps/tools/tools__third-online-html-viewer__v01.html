<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Online Viewer Pro</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            height: 100vh;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            display: flex;
        }
        
        .sidebar {
            width: 60px;
            background: #1e1e1e;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 0;
            gap: 5px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.3);
            z-index: 100;
            position: relative;
        }
        
        .sidebar-btn {
            width: 45px;
            height: 45px;
            background: transparent;
            border: none;
            color: #858585;
            cursor: pointer;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            position: relative;
        }
        
        .sidebar-btn:hover {
            background: #2d2d30;
            color: #ffffff;
        }
        
        .sidebar-btn i {
            font-size: 20px;
        }
        
        .sidebar-btn .tooltip-text {
            position: absolute;
            left: 65px;
            background: #2d2d30;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            white-space: nowrap;
            font-size: 13px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 1000;
        }
        
        .sidebar-btn:hover .tooltip-text {
            opacity: 1;
        }
        
        input[type="file"] {
            display: none;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .header {
            background: #2c3e50;
            color: white;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .header h1 {
            font-size: 1.3rem;
            margin: 0;
        }
        
        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .api-key-input {
            padding: 6px 12px;
            border-radius: 4px;
            border: 1px solid #34495e;
            background: #34495e;
            color: white;
            width: 300px;
        }
        
        .api-key-input::placeholder {
            color: #95a5a6;
        }
        
        .editor-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .line-numbers {
            background: #1e1e1e;
            color: #858585;
            padding: 15px 10px;
            text-align: right;
            font-family: 'Courier New', Consolas, monospace;
            font-size: 14px;
            line-height: 21px;
            user-select: none;
            border-right: 1px solid #333;
            overflow: hidden;
            min-width: 50px;
        }
        
        .editor-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        #editor {
            flex: 1;
            font-family: 'Courier New', Consolas, monospace;
            font-size: 14px;
            padding: 15px;
            border: none;
            resize: none;
            background: #1e1e1e;
            color: #d4d4d4;
            overflow: auto;
            outline: none;
            line-height: 21px;
        }
        
        .preview-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            border-left: 2px solid #333;
        }
        
        .panel-header {
            background: #34495e;
            color: white;
            padding: 10px 15px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        #preview {
            flex: 1;
            border: none;
            background: white;
            width: 100%;
        }
        
        .ai-panel {
            position: fixed;
            right: -400px;
            top: 0;
            width: 400px;
            height: 100vh;
            background: #2d2d30;
            box-shadow: -2px 0 10px rgba(0,0,0,0.3);
            transition: right 0.3s;
            display: flex;
            flex-direction: column;
            z-index: 200;
        }
        
        .ai-panel.active {
            right: 0;
        }
        
        .ai-header {
            background: #1e1e1e;
            padding: 15px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .ai-close {
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 20px;
        }
        
        .ai-chat {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .ai-message {
            padding: 10px 15px;
            border-radius: 8px;
            max-width: 85%;
            word-wrap: break-word;
        }
        
        .ai-message.user {
            background: #3498db;
            color: white;
            align-self: flex-end;
        }
        
        .ai-message.assistant {
            background: #34495e;
            color: white;
            align-self: flex-start;
        }
        
        .ai-input-area {
            padding: 15px;
            background: #1e1e1e;
            display: flex;
            gap: 10px;
        }
        
        .ai-input {
            flex: 1;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #444;
            background: #2d2d30;
            color: white;
            outline: none;
        }
        
        .ai-send {
            padding: 10px 20px;
            background: #3498db;
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
        }
        
        .ai-send:hover {
            background: #2980b9;
        }
        
        .quick-actions {
            padding: 15px;
            background: #252526;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .quick-action-btn {
            padding: 8px;
            background: #3c3c3c;
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            text-align: left;
            font-size: 13px;
        }
        
        .quick-action-btn:hover {
            background: #4a4a4a;
        }
        
        .fullscreen {
            position: fixed !important;
            top: 0;
            left: 0;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 9999;
        }
        
        .status-bar {
            background: #007acc;
            color: white;
            padding: 4px 15px;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <button class="sidebar-btn" onclick="openPreviewTab()">
            <i class="fas fa-external-link-alt"></i>
            <span class="tooltip-text">Preview in New Tab</span>
        </button>
        
        <button class="sidebar-btn" onclick="formatCode()">
            <i class="fas fa-magic"></i>
            <span class="tooltip-text">Format Code</span>
        </button>
        
        <button class="sidebar-btn" onclick="clearAll()">
            <i class="fas fa-trash"></i>
            <span class="tooltip-text">Clear</span>
        </button>
        
        <button class="sidebar-btn" onclick="document.getElementById('fileInput').click()">
            <i class="fas fa-file-import"></i>
            <span class="tooltip-text">Import HTML</span>
        </button>
        <input type="file" id="fileInput" accept=".html,.htm" onchange="importFile(event)">
        
        <button class="sidebar-btn" onclick="exportFile()">
            <i class="fas fa-file-export"></i>
            <span class="tooltip-text">Export HTML</span>
        </button>
        
        <button class="sidebar-btn" onclick="toggleFullscreen()">
            <i class="fas fa-expand"></i>
            <span class="tooltip-text">Fullscreen</span>
        </button>
        
        <div style="flex: 1;"></div>
        
        <button class="sidebar-btn" onclick="toggleAI()">
            <i class="fas fa-robot"></i>
            <span class="tooltip-text">AI Assistant</span>
        </button>
    </div>
    
    <div class="main-content">
        <div class="header">
            <h1><i class="fas fa-code"></i> HTML Online Viewer Pro</h1>
            <div class="header-actions">
                <input type="password" class="api-key-input" id="apiKey" placeholder="Enter ChatGPT API Key (optional)">
            </div>
        </div>
        
        <div class="editor-container">
            <div class="line-numbers" id="lineNumbers"></div>
            
            <div class="editor-wrapper">
                <textarea id="editor" spellcheck="false"><!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Page</title>
<style>
body {
font-family: Arial, sans-serif;
max-width: 800px;
margin: 50px auto;
padding: 20px;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
color: white;
}
h1 {
text-align: center;
font-size: 2.5rem;
margin-bottom: 20px;
}
.card {
background: rgba(255, 255, 255, 0.1);
backdrop-filter: blur(10px);
padding: 30px;
border-radius: 15px;
box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}
button {
background: white;
color: #667eea;
border: none;
padding: 10px 20px;
border-radius: 5px;
cursor: pointer;
font-size: 16px;
margin-top: 15px;
}
button:hover {
background: #f0f0f0;
}
</style>
</head>
<body>
<div class="card">
<h1>Welcome to HTML Viewer Pro! ðŸš€</h1>
<p>Edit code, get AI assistance, and preview instantly!</p>
<button onclick="alert('Hello!')">Click Me!</button>
</div>
</body>
</html></textarea>
                <div class="status-bar">
                    <span id="statusInfo">Line 1, Column 1</span>
                    <span id="charCount">0 characters</span>
                </div>
            </div>
            
            <div class="preview-panel">
                <div class="panel-header">
                    <span>Live Preview</span>
                </div>
                <iframe id="preview" sandbox="allow-scripts allow-same-origin allow-forms allow-modals"></iframe>
            </div>
        </div>
    </div>
    
    <div class="ai-panel" id="aiPanel">
        <div class="ai-header">
            <h3><i class="fas fa-robot"></i> AI Assistant</h3>
            <button class="ai-close" onclick="toggleAI()">Ã—</button>
        </div>
        
        <div class="quick-actions">
            <button class="quick-action-btn" onclick="aiQuickAction('fix')">
                <i class="fas fa-wrench"></i> Fix Bugs & Errors
            </button>
            <button class="quick-action-btn" onclick="aiQuickAction('optimize')">
                <i class="fas fa-tachometer-alt"></i> Optimize Code
            </button>
            <button class="quick-action-btn" onclick="aiQuickAction('explain')">
                <i class="fas fa-question-circle"></i> Explain Code
            </button>
            <button class="quick-action-btn" onclick="aiQuickAction('improve')">
                <i class="fas fa-star"></i> Improve Design
            </button>
        </div>
        
        <div class="ai-chat" id="aiChat"></div>
        
        <div class="ai-input-area">
            <input type="text" class="ai-input" id="aiInput" placeholder="Ask AI to help with your code...">
            <button class="ai-send" onclick="sendToAI()"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.7/beautify-html.min.js"></script>
    <script>
        const editor = document.getElementById('editor');
        const preview = document.getElementById('preview');
        const lineNumbers = document.getElementById('lineNumbers');
        const apiKey = document.getElementById('apiKey');
        const aiPanel = document.getElementById('aiPanel');
        const aiChat = document.getElementById('aiChat');
        const aiInput = document.getElementById('aiInput');
        
        let isFullscreen = false;
        
        function updatePreview() {
            const code = editor.value;
            const blob = new Blob([code], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            preview.src = url;
        }
        
        function updateLineNumbers() {
            const lines = editor.value.split('\n').length;
            lineNumbers.innerHTML = Array.from({length: lines}, (_, i) => i + 1).join('\n<br>');
        }
        
        function updateStatus() {
            const text = editor.value;
            const pos = editor.selectionStart;
            const beforeCursor = text.substring(0, pos);
            const line = beforeCursor.split('\n').length;
            const col = beforeCursor.split('\n').pop().length + 1;
            
            document.getElementById('statusInfo').textContent = `Line ${line}, Column ${col}`;
            document.getElementById('charCount').textContent = `${text.length} characters`;
        }
        
        editor.addEventListener('input', () => {
            updatePreview();
            updateLineNumbers();
            updateStatus();
        });
        
        editor.addEventListener('scroll', () => {
            lineNumbers.scrollTop = editor.scrollTop;
        });
        
        editor.addEventListener('click', updateStatus);
        editor.addEventListener('keyup', updateStatus);
        
        editor.addEventListener('keydown', function(e) {
            if (e.key === 'Tab') {
                e.preventDefault();
                const start = this.selectionStart;
                const end = this.selectionEnd;
                this.value = this.value.substring(0, start) + '  ' + this.value.substring(end);
                this.selectionStart = this.selectionEnd = start + 2;
            }
        });
        
        aiInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendToAI();
        });
        
        function formatCode() {
            try {
                const formatted = html_beautify(editor.value, {
                    indent_size: 2,
                    indent_char: ' ',
                    max_preserve_newlines: 2,
                    preserve_newlines: true,
                    indent_inner_html: true,
                    wrap_line_length: 0
                });
                editor.value = formatted;
                updatePreview();
                updateLineNumbers();
            } catch (e) {
                alert('Error formatting: ' + e.message);
            }
        }
        
        function openPreviewTab() {
            const newWin = window.open();
            newWin.document.write(editor.value);
            newWin.document.close();
        }
        
        function clearAll() {
            if (confirm('Clear all code?')) {
                editor.value = '';
                updatePreview();
                updateLineNumbers();
            }
        }
        
        function importFile(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    editor.value = e.target.result;
                    updatePreview();
                    updateLineNumbers();
                };
                reader.readAsText(file);
            }
        }
        
        function exportFile() {
            const blob = new Blob([editor.value], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'index.html';
            a.click();
            URL.revokeObjectURL(url);
        }
        
        function toggleFullscreen() {
            const previewPanel = document.querySelector('.preview-panel');
            isFullscreen = !isFullscreen;
            
            if (isFullscreen) {
                previewPanel.classList.add('fullscreen');
            } else {
                previewPanel.classList.remove('fullscreen');
            }
        }
        
        function toggleAI() {
            aiPanel.classList.toggle('active');
        }
        
        function addMessage(content, type) {
            const msg = document.createElement('div');
            msg.className = `ai-message ${type}`;
            msg.textContent = content;
            aiChat.appendChild(msg);
            aiChat.scrollTop = aiChat.scrollHeight;
        }
        
        async function sendToAI() {
            const message = aiInput.value.trim();
            if (!message) return;
            
            const key = apiKey.value.trim();
            if (!key) {
                alert('Please enter your ChatGPT API key in the header');
                return;
            }
            
            addMessage(message, 'user');
            aiInput.value = '';
            
            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${key}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4',
                        messages: [
                            {
                                role: 'system',
                                content: 'You are an expert HTML/CSS/JavaScript developer helping to fix, improve, and explain code. Keep responses concise and practical.'
                            },
                            {
                                role: 'user',
                                content: `Here is my HTML code:\n\n${editor.value}\n\nQuestion: ${message}`
                            }
                        ],
                        max_tokens: 1000
                    })
                });
                
                const data = await response.json();
                const reply = data.choices[0].message.content;
                addMessage(reply, 'assistant');
            } catch (error) {
                addMessage('Error: ' + error.message, 'assistant');
            }
        }
        
        function aiQuickAction(action) {
            const actions = {
                'fix': 'Find and fix any bugs or errors in my HTML code',
                'optimize': 'Optimize this code for better performance',
                'explain': 'Explain what this code does',
                'improve': 'Suggest improvements to the design and layout'
            };
            
            aiInput.value = actions[action];
            sendToAI();
        }
        
        updatePreview();
        updateLineNumbers();
        updateStatus();
    </script>
</body>
</html>